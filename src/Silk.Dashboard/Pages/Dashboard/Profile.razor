@page "/profile"

@attribute [Authorize]

@inherits DashboardPageBase

@if (_joinedGuilds is null)
{
    <LoadingView/>
}
else
{
    <MudContainer>
        <HeaderView ImageUrl="@CurrentUserAvatar" Text="@HeaderViewGreeting"/>

        <MudDivider Class="my-6" Style="height: 4px" DividerType="DividerType.Middle"/>

        <MudContainer Class="my-6">
            <MudText Class="mb-4" Typo="Typo.h4" GutterBottom="true">
                Servers you Manage
            </MudText>

            <MudGrid>
                <MudItem xs="12">
                    <MudGrid Spacing="4" Justify="Justify.Center">
                        <CollectionView Data="_managedGuilds">
                            <ItemTemplate>
                                <MudItem @key="context.ID.Value.Value">
                                    <GuildView Guild="context"
                                               OnClick="NavigateToManageGuild"/>
                                </MudItem>
                            </ItemTemplate>
                        </CollectionView>
                    </MudGrid>
                </MudItem>
            </MudGrid>

            <MudButton Class="my-8" 
                       Color="Color.Info" 
                       Variant="Variant.Filled"
                       OnClick="ToggleJoinedGuildsVisibility">
                @JoinedGuildsVisibilityText
            </MudButton>
        </MudContainer>

        @if (_showJoinedGuilds)
        {
            <MudContainer Class="my-8">
                <MudText Typo="Typo.h4" 
                         GutterBottom="true">
                    Servers you Joined
                </MudText>

                <MudGrid>
                    <MudItem xs="12">
                        <MudGrid Spacing="4" Justify="Justify.Center">
                            <CollectionView Data="_joinedGuilds">
                                <ItemTemplate>
                                    <MudItem @key="context.ID.Value.Value">
                                        <GuildView Guild="context"
                                                   OnClick="NavigateToManageGuild"/>
                                    </MudItem>
                                </ItemTemplate>
                            </CollectionView>
                        </MudGrid>
                    </MudItem>
                </MudGrid>
            </MudContainer>
        }
    </MudContainer>
}