@using Silk.Dashboard.Extensions
@using Silk.Dashboard.Themes

@inject NavigationManager NavManager

<CascadingAuthenticationState>
    <Router AppAssembly="@typeof(App).Assembly">
        <Found Context="routeData">
            <AuthorizeRouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)">
                <NotAuthorized>
                    @if (!context.User.IsAuthenticated())
                    {
                        <ProblemView Message="Please login to get started with the Dashboard"
                                     ImageUrl="images/rp_scare.png">

                            <form action="api/auth/login" method="post">
                                <MudButton ButtonType="ButtonType.Submit"
                                           Size="Size.Large"
                                           StartIcon="@Icons.Material.Filled.Login">
                                    Login
                                </MudButton>
                                <input type="hidden" name="returnUrl" value="@NavManager.Uri">
                            </form>
                        </ProblemView>
                    }
                    else
                    {
                        <ProblemView Message="Would love to let you through, but you need some permissions" 
                                      ImageUrl="images/rp_no.png" />
                    }
                </NotAuthorized>
            </AuthorizeRouteView>
        </Found>

        <NotFound>
            <LayoutView Layout="@typeof(MainLayout)">
                <ProblemView>
                    <MudButton Size="Size.Large" 
                               Color="Color.Info" 
                               Href="/"
                               StartIcon="@Icons.Material.Filled.Home">
                        Home
                    </MudButton>
                </ProblemView>
            </LayoutView>
        </NotFound>
    </Router>
</CascadingAuthenticationState>

<MudThemeProvider Theme="@ThemeManager.CurrentTheme" />
<MudDialogProvider />
<MudSnackbarProvider />